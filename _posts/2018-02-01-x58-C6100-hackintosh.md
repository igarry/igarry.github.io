layout: single
title: "C6100双系统安装（High Sierra、Windows 10）"
categories:
  - Edge Case
tags:
 - 黑苹果
 - hackintosh
 - High Sierra
 - legacy
 - dual systems
 - Windows 10
 - x58
 - Dell C6100
 - DIY
date: 2018-02-10 22:00:00 +0800


 Table of Contents 前言硬件最终效果双系统安装安装macOS1后续完善macOS（可选）安装Windows 10

前言

本文简单记录了我以家用为目的自行组建的C6100，以及介绍在一块SSD中安装双系统（macOS High Sierra 以及 Windows 10）的方法。其中Windows 10可以说是完美安装了，没有什么问题；macOS除了Handoff都没问题（其它的App Store，Message，FaceTime，AirDrop都没问题），如果哪位朋友解决了请告知。

想要直接按照本文安装的朋友，请确认你的机器是C6100，虽然理论上而言x58都可以按照这个方法成功安装，但除了C6100外的机器都没有测试过。而且有一个前提，你需要有一台运行macOS的电脑。

如果你实在是没办法弄到一台运行macOS的电脑，可以搜索一下Windows下如何使用制作使用Clover引导的U盘，然后再下载EFI、MultiBeast6以及Install macOS High Sierra5覆盖至U盘中。

本文内容基本

<figure class="align-center">



  <figcaption>可以看到Handoff Support已经是YES了，然而还是用不了。</figcaption>

</figure> 

硬件



硬件嘛，玩x58都懂的，我这里花了不少没必要的，大家引以为鉴吧。如果打算好好用黑苹果的话，建议上SSD，并且网卡要买黑苹果免驱的PCIE网卡。

最终效果

<figure class="align-center">



  <figcaption>macOS High Sierra</figcaption>

</figure> 

双系统安装

安装macOS1

1. 下载macOS High Sierra
   1. 打开App Store
   2. 使用Apple ID登录
   3. 下载macOS High Sierra
   下载完成后，Install macOS High Sierra会出现在/Applications。想百度网盘的可以到这里。
2. 使用UniBeast创建一个USB启动盘
   1. 打开U盘
   2. 用Finder打开路径（快捷键cmd+g）/Applications/Utilities/Disk Utility
   3. 在左侧选中你的U盘
      
   4. 点击抹掉按钮
   5. 名称随便填
   6. 格式选择Mac OS 拓展（日志式）
      
   7. 处理完U盘之后，下载UniBeast2
      
   8. 把你的系统语言改成English
      
      
   9. 运行UniBeast，一直点Continue和Agree，直到如图的画面选择你的U盘
      
   10. 在Select OS Installation页面选择High Sierra，点击Continue
   11. 在Bootloaders页面选择Legacy Boot Mode
   12. （可选）在Graphics Configuration页面选择你对应的显卡，点击Continue
   13. 在Installation页面确认你之前的选择无误后，点击Continue，等待安装结束
   14. 把下载好的MultiBeast拖到U盘里
3. 关于BIOS的设置
   1. Power management选择OS control
   2. 使用ACHI模式
   3. Boot中调整开机顺序为U盘优先
4. 安装macOS High Sierra
   1. 插上U盘，确认BIOS中的启动盘是你的U盘
   2. 你会进入Clover的启动页面
      <figure>
      
      </figure> 
      正常情况下你应该会进入Installer页面，如果点进去出现禁止符号，那估计是你的EFI有问题，可以试试下载这个EFI。或者你也可以试试在Clover启动页面，选择硬盘后不按回车，先按空格，输入-x进入安全模式试试。
   3. 在Installer页面你可以选择language切换语言为中文，这里继续用英文（懒得翻译）
   4. 现在要做的是将你想要安装系统的分区格式化，黑苹果最好保留60G以上，如果你打算长期用黑苹果，当然是越多越好了。
      - 在顶部菜单栏选择Utilities然后点击Disk Utility
      - 在左边选择你想安装的硬盘
      - 点击Erase
      - Name随便起
      - Format选择Mac OS Extended (Journaled)
      - 点击Erase
      - 好了干掉数据之后就选择Partition
      - 点一下+增加分区，然后调整好你的分区大小，Name随便起好你的分区名，例如High Sierra
      - 点击Apply
      - 关掉Disk Utility
   5. 选择你分好的区High Sierra，安装黑苹果
   6. 完成后系统会自动重启
   这里有个问题，High Sierra的文件系统是AFPS，不再是HFS。如果你不希望使用AFPS的话，可以到tonymax86的安装指引中搜索“Prevent APFS file system- default to HFS”参考。
   1. 继续通过U盘进入Clover启动页面
   2. 选择你安装好黑苹果的分区High Sierra
   3. 系统继续安装，完成后会自动重启
5. 使用MultiBeast安装部分驱动
   1. 继续通过U盘进入Clover启动页面
   2. 选择你安装好黑苹果的分区High Sierra
   3. 进行一系列的向导安装blablabla，最后进入系统桌面
   4. 运行MultiBeast
   5. Quick Start下面选择Legacy Boot Mode
   6. 选择你要安装的驱动，具体细节自行搜索吧，没有什么特别的话，C6100在这里只需要选择Drivers，左边选择Network，右边下拉Intel选AppleIGB v5.3.5.3
      
   7. 点击Click然后Install，在这之后你的电脑就可以脱离U盘启动了
   到这里基本上该做的都做好了，重启之后你就能用了。接下来介绍的是其他的问题，如果你的显卡没问题，App Store也能用，那么你就完成了macOS的安装。

后续完善macOS（可选）

这部分是可选的部分，如果想系统完善一点可以考虑把这部分给完成了。

1. 安装Nvidia显卡驱动 3
   1. 下载官方的驱动，想找最新的版本去这里，然后各种Continue直到安装完毕
   2. 打开下载好的Clover Configurator7
   3. 弹出警告不用理，在左边菜单栏选择Mount EFI，找到你的EFI分区并点Mount Partition
      
   4. 使用Clover Configurator打开/Volumes/EFI/EFI/CLOVER/config.plist 
   5. 左边菜单选中System Parameters，在右边勾选NvidiaWeb
   6. 重启再次进入系统，显卡正常工作
   如果加载系统的进度条去到一半屏幕黑了，显卡风扇狂转，没关系，屏幕马上会再次点亮，然后你会看到显示的分辨率达到显示器的实际分辨率了，这就证明显卡已经正常工作。
2. 修复HDMI/DP音频4
   1. 打开Clover Configurator，然后Mount EFI
   2. 下载SSDT-HDMI-NVIDIA-PEG0.aml9，放到EFI分区的/EFI/CLOVER/ACPI/patched/目录下
   3. 下载HDMIAudio.kext10，放到EFI分区的EFI/CLOVER/kexts/Other/目录下
   4. 重启，HDMI/DP能用了，但是不能使用软件控制音量
   5. 
3. 修复App Store，Messages和FaceTime8
   1. 前提是你已经安装了驱动AppleIGB v5.3.5.3
   2. 在系统报告里面你的以太网应该是en0，如果不是的话，打开终端执行以下命令
      cd ~/Library/Preferences/SystemConfiguration
      rm NetworkInterfaces.plist
      rm Preferences.plist
   3. 打开Clover Configurator，然后Mount EFI
   4. 使用Clover Configurator打开/Volumes/EFI/EFI/CLOVER/config.plist
   5. 左边菜单栏选择SMBIOS，右边按如图的按钮，选择你希望模拟的mac，我选的是MacPro4,1
      
   6. 点击Generate New按钮然后复制生成的Serial Number
   7. 打开网站https://checkcoverage.apple.com/cn/zh，在请输入你的序列号输入框粘贴刚刚复制的Serial Number，然后输入验证码，点击继续
   8. 如果显示的不是「很抱歉，这个序列号无效。请检查您的信息并再试一次。」，那么请重复上一步直至显示这段文字为止
   9. 回到Clover Configurator点击左边菜单的System Parameters，在右边点击Generate New，剪切生成的的UUID
   10. 点击左边菜单栏SMBIOS，在右边空白的SmUUID中粘贴你刚刚剪切的UUID
   11. 左边菜单点击Rt Variables，右边点几下Generate按钮
   12. 点击Generate按钮上面的下拉选单，选中UseMacAddr0
   13. 复制下面info框中MLB对应的键值，粘贴到上面空白的MLB输入框中
   14. BooterConfig填写0x28，CsrActiveConfig填写0x67
   15. 保存并退出Clover Configurator
   16. 打开终端，输入以下命令
       cd ~/Library/Caches
       rm -R com.apple.imfoundation.IMRemoteURLConnectionAgent*
       rm -R com.apple.Message*
       cd ~/Library/Preferences
       rm -R com.apple.iChat*
       rm -R com.apple.imagent*
       rm -R com.apple.imessage*
       rm -R com.apple.imservice*
       cd ~/Library
       rm -R Messages
   17. 打开磁盘工具，选中你的系统盘，点击急救，然后各种确认，等待完成小绿勾
   18. 重启

安装Windows 10



[1]: 主要参考翻译自UniBeast: Install macOS High Sierra on Any Supported Intel-based PC
[2]: 转存自UniBeast 8.1.0
[3]: 参考自Alternate NVIDIA Graphics Drivers
[4]: 参考翻译自Hackintosh HDMI Audio + DisplayPort GFX Card Sound Guide
[5]: 转存自https://itunes.apple.com/cn/app/macos-high-sierra/id1246284741?mt=12
[6]: 转存自MultiBeast - High Sierra 10.2.0
[7]: 转存自http://mackie100projects.altervista.org/download-clover-configurator/
[8]: 主要参考翻译自How to Get Hackintosh Messages to Work Consistently、An iDiot's Guide To iMessage
[9]: 转存自SSDT-HDMI-NVIDIA-PEG0.aml
[10]: 转存自HDMIAudio.kext 

